- builder:
    name: build-registry-add

    builders:
    - trigger-builds:
      - project: '{pipeline}.{version}.{project}.register-build'
        # muted while not debugged
        # block: true
        block: false
        predefined-parameters: |
          BUILD_IDENTITY={build-identity}
          NX_VMS_COMMIT={nx-vms-commit}

- builder:
    name: build-registry-get-commit

    builders:
    - copyartifact:
        project: '{pipeline}.{version}.{project}.register-build'
        filter: 'NX_VMS_COMMIT.envvar'
        which-build: last-successful
        parameter-filters: BUILD_IDENTITY={build-identity}
        optional: false
    - inject:
        properties-file: 'NX_VMS_COMMIT.envvar'
