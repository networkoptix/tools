- job-group:
    name: release/vms-with-all-possible-builds

    # Some cmake args are applicable for any builds they are applied at first
    # Run cmake -L / cmake -LH / cmake -LAH to see all configuration options
    cmake_configure_beta: '$BETA'
    cmake_configure_developer_build: 'OFF'
    cmake_configure_cloud_group: $CLOUD_GROUP

    # REMINDER: runner will not change list of subprojects when
    # extra items are added or removed, so don't forget to change runner
    # template according to changes made here
    platform:
    # there is also edge1 platform, it's declared and commented in jobs section
    - linux-x64:
        # most of builds are linux cross-builds that built on "build-installer-linux"
        # here we make an anchor to avoid typos and other kind of missconfiguration in future
        distribution_build_node: &linux_node build-installer-linux
        # There are some CMake args that aplicable only for particular platform
        cmake_configure_generator: Ninja
        cmake_build_extra_args: >-
          -- -j 20
    - linux-x86:
        distribution_build_node: *linux_node
        cmake_configure_generator: Ninja
        cmake_configure_target_device: linux-x86
    - bananapi:
        distribution_build_node: *linux_node
        cmake_configure_generator: Ninja
        cmake_configure_target_device: bananapi
        cmake_configure_with_tests: 'OFF'
    - bpi:
        distribution_build_node: *linux_node
        cmake_configure_generator: Ninja
        cmake_configure_target_device: bpi
    - rpi:
        distribution_build_node: *linux_node
        cmake_configure_generator: Ninja
        cmake_configure_target_device: rpi

    # - tx1:
    #     distribution_build_node: *linux_node
    #     cmake_configure_generator: Ninja
    #     cmake_configure_target_device: tx1
    # + edge1

    # -- windows platform --
    # FIXME: HOME,PATH and other vars are represented as win env.
    # But some other vars are linux-like.
    # Rsync goes mad ain result and nothing works.
    - windows-x64:
        distribution_build_node: build-installer-windows-hw-sign
        cmake_configure_generator: Visual Studio 15 2017 Win64
        cmake_configure_target_device: windows-x64
        cmake_configure_host: "x64"
        cmake_configure_add_qt_pdb: 'ON'

    - windows-x86:
        distribution_build_node: build-installer-windows-hw-sign
        cmake_configure_generator: Visual Studio 15 2017
        cmake_configure_with_tests: 'ON'
        cmake_configure_add_qt_pdb: 'ON'

    # -- apple platform --

    - mac:
        distribution_build_node: build-installer-mac
        use_webadmin: false
        cmake_configure_generator: Ninja
        cmake_configure_code_signing: 'OFF'
        cmake_build_extra_args: >-
          -- -j 10
    # SECTION. CUSTOMIZATION CONFIG
    # ============================================================

    # TODO: There are some customization that may be build only on specific platform
    # there is no need to generate extra set of jobs that never gonna be triggered.
    # it looks like there are too few customization spec. cmake args and we may move such
    # rare customizations to platform enum.

    cmake_configure_customization: $CUSTOMIZATION

    customization:

    # TODO: Enable later when we'll be ready to test it.

    # REMINDER: runner will not change list of subprojects when
    # extra items are added or removed, so don't forget to change runner
    # template according to changes made here
    - default:
        build_paxton: 'YES'
    - default_cn
    - default_zh_CN
    - cox
    - digitalwatchdog:
        build_paxton: 'YES'
    - digitalwatchdog_global
    - hanwha:
        build_paxton: 'YES'
    - ipera
    - ionetworks
    - nutech
    - ras
    - senturian
    - systemk
    - tricom
    - ust
    - vista:
        build_paxton: 'YES'
    - vmsdemoblue
    - vmsdemoorange
    - metavms
    - xccelo

    jobs:
    - '{pipeline}.{version}.{project}.runner'
    - webadmin/build
    - distribution-build
    # Edge1 is a platform that's exclusive for digitalwatchdog.
    # add extra jobs for edge1 with digitalwatchdog customization
    - distribution-build:
        platform:
        - edge1:
            distribution_build_node: *linux_node
            cmake_configure_generator: Ninja
            cmake_configure_target_device: edge1
        customization:
        - 'digitalwatchdog'

    # Our tests work per-customization per-platform and not yet implemented
    # for all platforms, so list of jobs is reduced
    # NOTE: If extra UT combinations are added, don't forget to add them in runner
    - distribution-all:
        # TODO: Rework a bit this parameterization as well as probably build node parameterization
        platform:
        - linux-x64:
            unittest_node: unittests-linux
        - mac:
            unittest_node: unittests-mac
        - windows-x64:
            unittest_node: unittests-windows
        customization:
        - default
