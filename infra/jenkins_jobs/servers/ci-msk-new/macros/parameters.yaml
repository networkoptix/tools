
# specific parameter for "registry-like" jobs
- parameter:
    name: p_REQUESTED_BY
    parameters:
    - string:
        name: REQUESTED_BY
        default: ''
        description: |
          Sticky label to mark individual build and query it's artifact in future
- parameter:
    name: p_UPSTREAM_JOB_NAME
    parameters:
    - string:
        name: UPSTREAM_JOB_NAME
        default: ''
        description: |
          JOB_NAME of upstream job - that is job which triggered this one.
- parameter:
    name: p_BUILD_DESCRIPTION
    parameters:
    - string:
        name: BUILD_DESCRIPTION
        default: '{default}'
        description: >-
          Free-style field to add some description for this build.
          This description will be posted on build page and also used in email notification.
          Use it to distinct one build from another.

# Common build parameters and build process customizations
- parameter:
    name: p_CLEAN_WORKSPACE  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: CLEAN_WORKSPACE
        default: '{default}'
        description: >-
          Build strategy, don't even try to reuse existing workspace.
          Clean EVERYTHING (HG repos, build, distrib and other folders).

- parameter:
    name: p_CLEAN_CLONE  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: CLEAN_CLONE
        default: false
        description: >-
          Build strategy, don't try to reuse currently cloned repositories.
          Clean repositories folders and reclone HG repos.

- parameter:
    name: p_CLEAN_BUILD  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: CLEAN_BUILD
        default: '{default}'
        description: >-
          Build strategy, don't try to reuse build folder from previous build in this workspace.
          This is very useful if you suspect that system incorrectly tries to perform incremental
          build that's not possible under current circumstances.

- parameter:
    name: p_BUILD_WEBADMIN
    parameters:
    - bool:
        name: BUILD_WEBADMIN
        default: '{default}'
        description: >-
          Normally you need to build webadmin, but there are few cases when you don't.
          For example, if build is related to only platform w/o servers included or when webadmin
          is already built and published under the same build identity.


# Parameters That fully define artifacts: what sources used and where to put what's built
- parameter:
    name: p_PIPELINE
    parameters:
    - string: &p_PIPELINE_OPTS
        name: PIPELINE
        default: '{default}'
        description: >-
          Build pipeline pipeline (e.g. custom, release and others)
- parameter:
    name: p_PIPELINE(hidden)
    parameters:
    - hidden: *p_PIPELINE_OPTS

- parameter:
    name: p_BRANCH
    parameters:
    - string:
        name: BRANCH
        default: '{default}'
        description: >-
          Branch of nx_vms from which product is built.

- parameter:
    name: p_NX_VMS_COMMIT
    parameters:
    - string:
        name: NX_VMS_COMMIT
        default: '{default}'
        description: >-
          Frozen nx_vms commit id or branch. commit sha is preferred as
          all builds will be produced within the same repo state

- parameter:
    name: p_USE_NX_VMS_COMMIT
    parameters:
    - string:
        name: USE_NX_VMS_COMMIT
        default: '{default}'
        description: >-
          Use AUTO, LATEST, branch name or exact sha of commit

- parameter:
    name: p_BUILD_IDENTITY
    parameters:
    - string:
        name: BUILD_IDENTITY
        default: ''
        description: >-
          Build number in context of this pipeline.

- parameter:
    name: p_USE_BUILD_IDENTITY
    parameters:
    - string:
        name: USE_BUILD_IDENTITY
        default: '{default}'
        description: >-
          Use NEW, or existing build

- parameter:
    name: p_PLATFORMS
    parameters:
    - extended-choice:
        name: PLATFORMS
        type: 'multi-select'
        value: '{default}'
        default-value: '{default}'
        visible-items: 10
        description: >-
          Target platforms for distributions

- parameter:
    name: p_PLATFORM
    parameters:
    - string: &p_PLATFORM_OPTS
        name: PLATFORM
        default: '{default}'
        description: >
          Target platform for installer (e.g. linux-x64, windows-x86 and others,
          note that universal is used for webadmin and other platform-independent components)

- parameter:
    name: p_PLATFORM(hidden)
    parameters:
    - hidden: *p_PLATFORM_OPTS

- parameter:
    name: p_CUSTOMIZATIONS
    parameters:
    - extended-choice:
        name: CUSTOMIZATIONS
        type: 'multi-select'
        value: '{default}'
        default-value: '{default}'
        visible-items: 10
        description: >-
          Target customizations for distributions
- parameter:
    name: p_CUSTOMIZATION
    parameters:
    - string: &p_CUSTOMIZATION_OPTS
        name: CUSTOMIZATION
        default: '{default}'
        description: >
          Name of installer customization (e.g. default, hanwha and others)
- parameter:
    name: p_CUSTOMIZATION(hidden)
    parameters:
    - hidden: *p_CUSTOMIZATION_OPTS

- parameter:
    name: p_COMPONENTS
    parameters:
    - string:
        name: COMPONENTS
        default: ''
        description: >
          Name of components, mostly used in context of artifact repository as part of path
          where artifact will be located (uploaded to or downloaded from) â€” comma-separated list.
          Note that trailing slash matters.

# Utility parameters used to describe connection details
- parameter:
    name: p_NODE_SSH_CONNECTION
    parameters:
    - string:
        name: NODE_SSH_CONNECTION
        default: ''
        description: >
          Original ssh connection from Jenkins SSH_CONNECTION envvar,
          (<src host> <src port> <dst host> <dst port> NOTE, FOUR VARS in string),
          example - 192.168.13.105 43896 192.168.13.116 22

- parameter:
    name: p_SSH_USER
    parameters:
    - string:
        name: SSH_USER
        description: >
          Name of ssh user used for ssh session (usually jenkins, but it may differ for
          edge cases)

# Define paths to operate on
- parameter:
    name: p_LOCAL_PATH
    parameters:
    - string:
        name: LOCAL_PATH
        default: ''
        description: >
          Local path on remote host

# Advanced usage
- parameter:
    name: administrative-section-separator
    parameters:
    - simple-separator:
        header: >-
          Special section for administrative/maintenance purposes..
          DON'T MODIFY anything if you are not administrator

- parameter:
    name: p_BUILD_STATUS
    parameters:
    - string:
        name: BUILD_STATUS
        default: passed
        description: >-
          Build status to report, note that THIS ENUM DOES NOT CONFORM
          with JENKINS ENUMs, valid options are "passed" and "failed"

- parameter:
    name: p_RUN_FUNCTESTS  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: RUN_FUNCTESTS
        default: '{default}'
        description: >-
          Flag whether run functests or not.

- parameter:
    name: p_RUN_REALCAMERATESTS  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: RUN_REALCAMERATESTS
        default: '{default}'
        description: >-
          Flag whether run realcameratests or not.

- parameter:
    name: p_RUN_UNITTESTS  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: RUN_UNITTESTS
        default: '{default}'
        description: >-
          Flag whether run functests or not.

- parameter:
    name: p_BUILD_INSTALLER  # TODO: switch to *_SKIP
    parameters:
    - bool:
        name: BUILD_INSTALLER
        default: '{default}'
        description: >-
          Flag whether to build installer or not

- parameter:
    name: p_RUNNER_URL
    parameters:
    - string:
        name: RUNNER_URL
        description: utility parameter, url for root build (runner)

- parameter:
    name: p_JUNKSHOP_HOST
    parameters:
    - string:
        name: JUNKSHOP_HOST

- parameter:
    name: p_CUSTOM_CMAKE_PARAMETERS
    parameters:
    - string:
        name: CUSTOM_CMAKE_PARAMETERS
        default: '{default}'

- parameter:
    name: p_CLOUD_GROUP
    parameters:
    - better-single-select:
        name: CLOUD_GROUP
        choices:
        - - test
          - test   # TODO: Write description
        - - tmp
          - tmp    # TODO: Write description
        - - dev
          - dev    # TODO: Write description
        - - demo
          - demo   # TODO: Write description
        - - stage
          - stage  # TODO: Write description
        - - prod
          - prod   # TODO: Write description
        default: '{default}'
        description: >-
          Cloud group

- parameter:
    name: p_HARDWARE_SIGNING
    parameters:
    - on-off-option:
        name: HARDWARE_SIGNING
        default: '{default}'

- parameter:
    name: p_TRUSTED_TIMESTAMPING
    parameters:
    - on-off-option:
        name: TRUSTED_TIMESTAMPING
        default: '{default}'

# Functional tests parameters

- parameter:
    name: p_TEST_SELECT_EXPR
    parameters:
    - string:
        name: TEST_SELECT_EXPR
        default: '{default}'
        description: >
          Test selection expression, parameter for pytest '-k' option.
          Empty means run all tests specified in TEST_LIST parameter below.
          Example: 'not windows and not smb' to exclude all windows and samba tests.
          Value is passed as single argument enclosed with quotes. E.g. 'linux and ssh' would end up as '-k "linux and ssh"'.
          See: https://docs.pytest.org/en/latest/example/markers.html#using-k-expr-to-select-tests-based-on-their-name

- parameter:
    name: p_TEST_LIST
    parameters:
    - string:
        name: TEST_LIST
        default: '{default}'
        description: Tests to run, space-delimited list. Empty means run all tests.

- parameter:
    name: p_VMS_BUILD_w_OPTION
    parameters:
    - better-single-select:
        name: VMS_BUILD
        choices:
        - - VMS_NEW_BUILD_BY_COMMIT
          - "Make new build (ENTER commit)"
        - - VMS_EXIST_BUILD_BY_IDENTITY
          - "Existing build (ENTER build identity)"
        - - VMS_EXIST_BUILD_STABLE_PUSH
          - "Existing green build (latest push)"
        - - VMS_EXIST_BUILD_STABLE_NIGHTLY
          - "Existing green build (latest nightly)"
        - - VMS_EXIST_BUILD_STABLE_PUSH_OR_NIGHTLY
          - "Existing green build (latest push or nightly)"
        default: '{default}'
        description: >-
          Which VMS build should be used
    - string:
        name: VMS_BUILD_OPTION
        default: '{option_default}'
        description: >-
          ENTER option for VMS_BUILD, optional, depending on what's selected in prev field

- parameter:
    name: p_FT_COMMIT_w_OPTION
    parameters:
    - better-single-select:
        name: FT_COMMIT
        choices:
        - - "FT_OTHER_COMMIT"
          - "Use other commit (ENTER commit)"
        - - "FT_STABLE_PUSH"
          - "Tested green (latest push)"
        - - "FT_STABLE_NIGHTLY"
          - "Tested green (latest nightly)"
        - - "FT_STABLE_PUSH_OR_NIGHTLY"
          - "Tested green(latest push or nightly)"
        default: '{default}'
        description: Which FT commit should be used
    - string:
        name: FT_COMMIT_OPTION
        default: '{option_default}'
        description: >-
          ENTER option for FT_COMMIT, optional, depending on what's selected in prev field

- parameter:
    name: p_RCT_COMMIT_w_OPTION
    parameters:
    - better-single-select:
        name: RCT_COMMIT
        choices:
        - - "RCT_BY_COMMIT"
          - "Use other commit (ENTER commit)"
        - - "RCT_STABLE_PUSH"
          - "Tested green (latest push)"
        - - "RCT_STABLE_NIGHTLY"
          - "Tested green (latest nightly)"
        - - "RCT_STABLE_PUSH_OR_NIGHTLY"
          - "Tested green(latest push or nightly)"
        default: '{default}'
        description: Which RCT commit should be used
    - string:
        name: RCT_COMMIT_OPTION
        default: '{option_default}'
        description: >-
          ENTER option for RCT_COMMIT, optional, depending on what's selected in prev field
