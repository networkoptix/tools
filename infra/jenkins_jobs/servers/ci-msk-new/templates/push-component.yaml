- job-template:
    name: 'helper.push-component'

    node: repository-ops

    concurrent: false  # important

    wrappers:
    - ssh-agent-credentials:
        users:
        - jenkins

    properties:
    - heavy-job:
        weight: 1
    - throttle:
        max-total: 1
        option: project

    parameters:
    # Parameters related to artifact location in repository
    - p_BUILD_IDENTITY
    - p_PLATFORM
    - p_CUSTOMIZATION
    - p_COMPONENTS
    # Parameter that defines path to operate it's actually remote path
    - p_LOCAL_PATH
    # Utility parameters used to describe connection details
    - p_NODE_SSH_CONNECTION
    - p_SSH_USER

    builders:

    - rsync-download:
        host: '$(echo "${{NODE_SSH_CONNECTION}}" | cut -d " " -f 3)'
        port: '$(echo "${{NODE_SSH_CONNECTION}}" | cut -d " " -f 4)'
        user: '${{SSH_USER}}'
        src_path: '${{LOCAL_PATH}}'
        dst_path: '{artifact_repository_base}/${{BUILD_IDENTITY}}/${{PLATFORM}}/${{CUSTOMIZATION}}/'
        components: '${{COMPONENTS}}'