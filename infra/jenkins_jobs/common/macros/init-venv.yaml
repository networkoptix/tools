# Create 'venv' directory, if it is not yet exists, install requirements
# Usage example:
#  - init-venv:
#      requirements-files: >-
#        test/requirements1.txt
#        test/requirements2.txt

- builder:
    name: init-venv
    builders:
    - shell: |
        #!shell
        if [ ! -d venv ]; then
          virtualenv --system-site-packages venv
        fi

        if [ -d venv/Scripts ] ; then
          source venv/Scripts/activate
        else
          source venv/bin/activate
        fi

        pip install --upgrade pip setuptools wheel
        for file in {requirements-files} ; do
          pip install --upgrade -r "$file"
        done
