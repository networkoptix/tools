# This step is not critical to be performed.
# So eject will be disabled as it's done in cloud init.
#
# - name: Get init Floppy dev name
#   xml:
#     xmlstring: "{{ domain_xml }}"
#     xpath: '/domain/devices/disk[source/@file="{{ libvirt_guest__init_media_img }}"]/target'
#     content: attribute
#     attribute: dev
#   when: "libvirt_guest__state == 'running'"
#   failed_when: false
#   register: _guest_init_media_info
#   delegate_to: "{{ libvirt_host }}" # packages may be not installed on guest yet
#
# - name: Eject Init Media
#   become: true
#   become_method: sudo
#   command: >-
#     virsh change-media {{ libvirt_guest__hostname }}
#     {{ _guest_init_media_info.matches[0].target.dev }} --eject
#   when:
#   - _guest_init_media_info.matches is defined
#   - _guest_init_media_info.matches[0].target.dev is defined
#   - >-
#     _guest_init_media_info.matches[0].target.tray is undefined or
#     _guest_init_media_info.matches[0].target.tray != 'open'
#   delegate_to: "{{ libvirt_host }}"
