# For development only: create VM for debugging scalability tests
- name: Create linux scalability (Ubuntu Xenial) VM
  hosts: virtual:&scalability
  become: true
  become_method: sudo
  # We don't know status of guest, so if we try to gather facts (=connect),
  # but this guest is not crated yet, we'll fail entire section.
  # That's why don't collect facts here.
  # All facts will be collected in libvirt_guest.
  gather_facts: no

  vars_files:
  - ../secrets/infra_storage.yml

  roles:
  - role: libvirt_guest


# For both development and prod
- name: Setup linux scalability host
  hosts: scalability
  become: true
  become_method: sudo

  vars_files:
  - ../secrets/infra_storage.yml

  roles:
  - role: scalability_node
