# docker-compose configuration file for junk_shop deployment
# Usage:
# $ export JUNK_SHOP_DB_DIR=<junk-shop postgres database location>
# $ export PGPASSWORD=<postgress password>
# $ docker-compose -f deploy/compose-deploy.yaml up -d

version: '2'

services:

  junk_shop_web:
    container_name: junk_shop_web
    image: junk_shop_web
    links:
      - junk_shop_db:database
    build:
      context: ..
      dockerfile: deploy/Dockerfile
    ports:
      - '80:80'
    environment:
      STATIC_PATH: /app/junk_shop/webapp/static
      JUNK_SHOP_SETTINGS: /app/settings.py
      PGPASSWORD:

  junk_shop_db:
    container_name: junk_shop_db
    image: postgres
    ports:
      - '5432:5432'
    environment:
      - PGPASSWORD
    volumes:
      - ${JUNK_SHOP_DB_DIR}:/var/lib/postgresql/data
